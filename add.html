<!DOCTYPE html>
<html>
<head>
    <title>Ajouter une offre d'emploi</title>
</head>
<body>
    <form id="offreForm" action="http://localhost:3000/ajouter-offre" method="POST">
        <label for="intitule">Intitulé :</label>
        <input type="text" id="intitule" name="intitule" ><br>
        <label for="description">Description :</label>
        <textarea id="description" name="description" ></textarea><br>
        <label for="dateCreation">Date de création :</label>
        <input type="date" id="dateCreation" name="dateCreation" ><br>
        <label for="dateActualisation">Date d'actualisation :</label>
        <input type="date" id="dateActualisation" name="dateActualisation" ><br>
        <label for="lieuTravail">Lieu de travail :</label>
        <input type="text" id="lieuTravail" name="lieuTravail" ><br>
        <label for="romeCode">Code ROME :</label>
        <input type="text" id="romeCode" name="romeCode" ><br>
        <label for="romeLibelle">Libellé ROME :</label>
        <input type="text" id="romeLibelle" name="romeLibelle" ><br>
        <label for="entreprise">Entreprise :</label>
        <input type="text" id="entreprise" name="entreprise" ><br>
        <label for="typeContrat">Type de contrat :</label>
        <input type="text" id="typeContrat" name="typeContrat" ><br>
        <label for="natureContrat">Nature du contrat :</label>
        <input type="text" id="natureContrat" name="natureContrat" ><br>
        <label for="experienceExige">Expérience exigée :</label>
        <input type="text" id="experienceExige" name="experienceExige" ><br>
        <label for="experienceLibelle">Libellé de l'expérience :</label>
        <input type="text" id="experienceLibelle" name="experienceLibelle" ><br>
        <label for="formations">Formations :</label>
        <input type="text" id="formations" name="formations" ><br>
        <label for="langues">Langues :</label> <!-- Ajoutez d'autres champs ici -->
        <label for="langues_libelle">Langues :</label>
        <input type="text" id="langues_libelle" name="langues_libelle" ><br>
        <label for="langues_exigence">Exigence langues :</label>
        <input type="text" id="langues_exigence" name="langues_exigence" ><br>
        <label for="competences">Compétences :</label>
        <input type="text" id="competences" name="competences" ><br>
        <label for="salaire">Salaire :</label>
        <input type="text" id="salaire" name="salaire" ><br>
        <label for="dureeTravailLibelle">Durée du travail :</label>
        <input type="text" id="dureeTravailLibelle" name="dureeTravailLibelle" ><br>
        <label for="dureeTravailLibelleConverti">Durée du travail convertie :</label>
        <input type="text" id="dureeTravailLibelleConverti" name="dureeTravailLibelleConverti" ><br>
        <label for="alternance">Alternance :</label>
        <input type="text" id="alternance" name="alternance" ><br>
        <label for="contact">Contact :</label>
        <input type="text" id="contact" name="contact" ><br>
        <label for="nombrePostes">Nombre de postes :</label>
        <input type="text" id="nombrePostes" name="nombrePostes" ><br>
        <label for="accessibleTH">Accessible aux TH :</label>
        <input type="text" id="accessibleTH" name="accessibleTH" ><br>
        <label for="qualificationCode">Code de qualification :</label>
        <input type="text" id="qualificationCode" name="qualificationCode" ><br>
        <label for="qualificationLibelle">Libellé de qualification :</label>
        <input type="text" id="qualificationLibelle" name="qualificationLibelle" ><br>
        <label for="codeNAF">Code NAF :</label>
        <input type="text" id="codeNAF" name="codeNAF" ><br>
        <label for="secteurActivite">Secteur d'activité :</label>
        <input type="text" id="secteurActivite" name="secteurActivite" ><br>
        <label for="secteurActiviteLibelle">Libellé de secteur d'activité :</label>
        <input type="text" id="secteurActiviteLibelle" name="secteurActiviteLibelle" ><br>
        <label for="origineOffre">Origine de l'offre :</label>
        <input type="text" id="origineOffre" name="origineOffre" ><br>
       
        <label for="lieu_libelle">lieu_libelle :</label>
        <input type="text" id="lieu_libelle" name="lieu_libelle" ><br>
        
        <label for="latitude">latitude :</label>
        <input type="text" id="latitude" name="latitude" ><br>
        
        <label for="codePostal">codePostal :</label>
        <input type="text" id="codePostal" name="codePostal" ><br>
        
        <label for="longitude">commune :</label>
        <input type="text" id="commune" name="commune" ><br>
        
        <label for="appellationLibelle">appellationLibelle :</label>
        <input type="text" id="appellationLibelle" name="appellationLibelle" ><br>
        
        <label for="entreprise_nom">entreprise_nom :</label>
        <input type="text" id="entreprise_nom" name="entreprise_nom" ><br>
        
        <label for="entrepriseAdaptee">entrepriseAdaptee :</label>
        <input type="text" id="entrepriseAdaptee" name="entrepriseAdaptee" ><br>
        
        <label for="longitude">longitude :</label>
        <input type="text" id="longitude" name="longitude" ><br>
        
        <label for="typeContratLibelle">typeContratLibelle :</label>
        <input type="text" id="typeContratLibelle" name="typeContratLibelle" ><br>
        
        <label for="formation_codeFormation">formation_codeFormation :</label>
        <input type="text" id="formation_codeFormation" name="formation_codeFormation" ><br>
        
        <label for="formation_domaineLibelle">formation_domaineLibelle :</label>
        <input type="text" id="formation_domaineLibelle" name="formation_domaineLibelle" ><br>
        
        <label for="formation_exigence">formation_exigence :</label>
        <input type="text" id="formation_exigence" name="formation_exigence" ><br>
        
        <label for="langue_exigence">langue_exigence :</label>
        <input type="text" id="langue_exigence" name="langue_exigence" ><br>
        
        <label for="langue_exigence">competence_code :</label>
        <input type="text" id="langue_exigence" name="langue_exigence" ><br>
        
        <label for="langue_exigence">competence_libelle :</label>
        <input type="text" id="langue_exigence" name="langue_exigence" ><br>
        
        <label for="competence_exigence">competence_exigence :</label>
        <input type="text" id="competence_exigence" name="competence_exigence" ><br>
        
        <label for="salaire_libelle">salaire_libelle :</label>
        <input type="text" id="salaire_libelle" name="salaire_libelle" ><br>
        
        <label for="contact_nom">contact_nom :</label>
        <input type="text" id="contact_nom" name="contact_nom" ><br>
        
        <label for="contact_coordonnees1">contact_coordonnees1 :</label>
        <input type="text" id="contact_coordonnees1" name="contact_coordonnees1" ><br>
        
        <label for="contact_coordonnees2">contact_coordonnees2 :</label>
        <input type="text" id="contact_coordonnees2" name="contact_coordonnees2" ><br>
        
        <label for="contact_coordonnees2">contact_coordonnees2 :</label>
        <input type="text" id="contact_coordonnees2" name="contact_coordonnees2" ><br>
        
        <label for="contact_coordonnees3">contact_coordonnees3 :</label>
        <input type="text" id="contact_coordonnees3" name="contact_coordonnees3" ><br>
        
        <label for="contact_coordonnees3">contact_coordonnees3 :</label>
        <input type="text" id="contact_coordonnees3" name="contact_coordonnees3" ><br>
        
        <label for="origineOffre_origine">origineOffre_origine :</label>
        <input type="text" id="origineOffre_origine" name="origineOffre_origine" ><br>
        
        <label for="formation_niveauLibelle">formation_niveauLibelle :</label>
        <input type="text" id="formation_niveauLibelle" name="formation_niveauLibelle" ><br>
        
        <label for="formation_commentaire">formation_commentaire :</label>
        <input type="text" id="formation_commentaire" name="formation_commentaire" ><br>
        
        <label for="langue_libelle">langue_libelle :</label>
        <input type="text" id="langue_libelle" name="langue_libelle" ><br>
        
        <label for="competence_code">competence_code :</label>
        <input type="text" id="competence_code" name="competence_code" ><br>
        
        <label for="competence_libelle">competence_libelle :</label>
        <input type="text" id="competence_libelle" name="competence_libelle" ><br>
        
        <label for="origineOffre_urlOrigine">origineOffre_urlOrigine :</label>
        <input type="text" id="origineOffre_urlOrigine" name="origineOffre_urlOrigine" ><br>
        
        <button type="submit">Ajouter Offre</button>
    </form>
</body>
<script>
    function ajouterOffre() {
        // Récupérer les valeurs du formulaire
        const formData = new FormData(document.getElementById("userForm"));

        // Convertir les données du formulaire en objet JavaScript
        const formDataObject = {};
        formData.forEach((value, key) => {
            formDataObject[key] = value;
        });

        // Envoyer les données au serveur pour enregistrement dans le fichier JSON
        ajouterAuFichierJSON(formDataObject);
    }

    function ajouterAuFichierJSON(data) {
        // Chemin vers le fichier JSON existant
        const cheminFichierJSON = 'offres.json';

        // Lire le contenu du fichier JSON
        fetch(cheminFichierJSON)
        .then(response => {
            if (!response.ok) {
                throw new Error('Impossible de lire le fichier JSON');
            }
            return response.json();
        })
        .then(donneesExistantes => {
            // Vérifier si le fichier JSON est vide
            if (!donneesExistantes) {
                donneesExistantes = []; // Initialiser avec un tableau vide si le fichier est vide
            }

            // Générer un ID unique pour l'offre
            const id = generateUniqueId();

            // Ajouter l'ID à l'objet de données
            data.id = id;

            // Ajouter les nouvelles données
            donneesExistantes.push(data);

            // Convertir les données JavaScript en chaîne JSON
            let donneesMisesAJour = JSON.stringify(donneesExistantes, null, 2);

            // Écrire les données mises à jour dans le fichier JSON
            fetch(cheminFichierJSON, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: donneesMisesAJour
            })
            .then(() => console.log("Données ajoutées avec succès au fichier JSON."))
            .catch(error => console.error("Erreur lors de l'écriture dans le fichier JSON :", error));
        })
        .catch(error => {
            if (error instanceof SyntaxError) {
                // Gérer le cas où le fichier JSON est vide
                console.error("Le fichier JSON est vide ou malformé.");
            } else {
                console.error("Erreur lors de la lecture ou du traitement du fichier JSON :", error);
            }
        });
    }

    // Fonction pour générer un ID unique
    function generateUniqueId() {
        return Math.random().toString(36).substring(2) + Date.now().toString(36);
    }
</script>


</html>